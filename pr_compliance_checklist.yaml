pr_compliances:
  - title: "Soc2Type2 — Input Validation"
    compliance_label: true
    objective: "To prevent injection attacks (e.g., SQL injection, XSS) by validating and sanitizing all user-supplied input."
    success_criteria: "All input fields (e.g., forms, API parameters, URL queries) have validation logic. Data is sanitized or parameterized before being used in queries or rendered in the UI."
    failure_criteria: "User input is used directly in database queries or rendered in HTML without proper validation, sanitization, or escaping, leading to potential injection vulnerabilities."

  - title: "Soc2Type2 — Secure Development Practices (OWASP Top 10)"
    compliance_label: true
    objective: "To adhere to industry-standard secure coding practices to minimize common security vulnerabilities."
    success_criteria: "The code shows awareness of common vulnerabilities like those listed in the OWASP Top 10, and includes countermeasures (e.g., proper session management, secure headers, protection against CSRF)."
    failure_criteria: "The code exhibits patterns of common vulnerabilities (e.g., insecure direct object references, security misconfiguration) without mitigation."

  - title: "Soc2Type2 — Principle of Least Privilege"
    compliance_label: true
    objective: "To ensure that users and system components have only the minimum levels of access—or permissions—needed to perform their functions."
    success_criteria: "Access to resources (files, database records, API endpoints) is restricted by default. Permissions are explicitly granted based on the user's role and need."
    failure_criteria: "Users or services have overly broad permissions, such as admin-level access for routine tasks, or can access data/functions they are not authorized for."

  - title: "Soc2Type2 — System Resilience (Fallbacks, Retries, Graceful Degradation)"
    compliance_label: true
    objective: "To ensure the system remains available and functional, even when dependencies or components fail."
    success_criteria: "The code includes mechanisms like retry logic for transient network errors, fallbacks to alternative data sources or services, and can degrade gracefully (e.g., disabling non-essential features) during outages."
    failure_criteria: "A failure in a single dependency (e.g., a third-party API) causes a complete service outage or unhandled exceptions."

  - title: "Soc2Type2 — Health Checks and Monitoring"
    compliance_label: true
    objective: "To provide visibility into the application's health and performance, enabling quick detection and diagnosis of issues."
    success_criteria: "The application exposes a health check endpoint (e.g., `/healthz`) that reports the status of critical dependencies. Custom metrics and logs are integrated for monitoring."
    failure_criteria: "There are no endpoints or hooks to check the application's health, making it difficult to monitor or automate recovery."

  - title: "Soc2Type2 — Role-Based Access Control (RBAC)"
    compliance_label: true
    objective: "To enforce authorization policies by restricting access to operations and data based on user roles."
    success_criteria: "An RBAC system is implemented. Before performing sensitive actions or accessing data, the code checks if the user's role has the required permissions."
    failure_criteria: "Access control checks are missing, or are based on easily spoofable attributes instead of a centrally managed role system. All users can access all features."

  - title: "Soc2Type2 — Audit Logging for Sensitive Operations"
    compliance_label: true
    objective: "To maintain a secure audit trail of all actions performed on sensitive data or critical system functions."
    success_criteria: "Actions such as creating, viewing, updating, or deleting sensitive data are logged. The log entry includes who performed the action, what was changed, and when it occurred."
    failure_criteria: "Sensitive operations are not logged, or logs lack sufficient detail to reconstruct the event, hindering security audits and incident response."

  - title: "Soc2Type2 — Data Integrity Checks"
    compliance_label: true
    objective: "To ensure the accuracy and consistency of data throughout its lifecycle."
    success_criteria: "The code includes validation steps at data entry points, and integrity checks (e.g., checksums, foreign key constraints) are used to prevent data corruption."
    failure_criteria: "Data is accepted without validation, potentially leading to corruption, incorrect processing, or system errors."

  - title: "Soc2Type2 — Deterministic Code Behavior"
    compliance_label: true
    objective: "To ensure that code produces consistent and predictable outcomes for the same set of inputs, which is crucial for data processing integrity."
    success_criteria: "Functions are pure where possible. The code avoids reliance on non-deterministic factors like time-of-day or un-ordered data structures for critical logic. Comprehensive unit and integration tests cover edge cases."
    failure_criteria: "The code produces different results for the same inputs under identical conditions, leading to unreliable data processing and potential integrity issues."

  - title: "GDPR — Data Minimization"
    compliance_label: true
    objective: "To ensure only personal data that is strictly necessary for the specific purpose is collected and processed."
    success_criteria: "The code only collects and stores data fields that are essential for the feature's functionality. No hardcoded PII or real user data is present in tests or source code."
    failure_criteria: "The code collects excessive user data (e.g., full address when only a city is needed). PII is hardcoded in the source, or real user data is used in test suites."

  - title: "GDPR — Data Security & Encryption"
    compliance_label: true
    objective: "To protect personal data from unauthorized access or breaches by using strong encryption for data in transit and at rest, and by securing credentials."
    success_criteria: "All data transmission occurs over secure channels (e.g., HTTPS). Sensitive data stored in databases is encrypted (e.g., using AES-256). No secrets, API keys, or credentials are hardcoded; they are managed through a secure secrets management system."
    failure_criteria: "Data is sent over unencrypted HTTP. Sensitive data is stored in plaintext. Secrets or credentials are found hardcoded in the source code or configuration files."

  - title: "GDPR — Data Subject Rights (Access, Correction, Deletion)"
    compliance_label: true
    objective: "To provide users with the ability to exercise their rights to access, rectify, and erase their personal data."
    success_criteria: "The application provides APIs or user-facing features to access, correct, and delete personal data. Deletion routines are implemented to remove user data from all systems upon request."
    failure_criteria: "There are no mechanisms for users to view, edit, or delete their data. Deletion requests only perform a soft delete (e.g., setting an `is_deleted` flag) without a process for permanent removal."

  - title: "GDPR — Data Retention & Deletion Policies"
    compliance_label: true
    objective: "To ensure personal data is not kept for longer than necessary for the purposes for which it was collected."
    success_criteria: "The code includes logic or scheduled jobs to automatically delete or anonymize data that has exceeded its retention period. 'Right to be forgotten' routines are implemented and regularly tested."
    failure_criteria: "Data is stored indefinitely with no automated deletion or anonymization process. There is no implemented 'right to be forgotten' feature."

  - title: "OWASP — Injection"
    compliance_label: true
    objective: "To prevent injection attacks (SQL, NoSQL, OS, etc.) by ensuring all data is treated as untrusted and properly handled."
    success_criteria: "The code uses parameterized queries or prepared statements for all database interactions. All user-supplied input (including headers, cookies, and URL parameters) is validated and sanitized before use."
    failure_criteria: "User input is directly concatenated into database queries or command-line executions. Input is not validated or sanitized, creating a potential for injection."

  - title: "OWASP — Broken Authentication"
    compliance_label: true
    objective: "To implement and enforce proper authentication and session management."
    success_criteria: "Passwords are not stored in plaintext; they are hashed using a strong, salted algorithm (e.g., bcrypt, Argon2). Sessions are invalidated upon logout and password changes. Multi-factor authentication is used where appropriate."
    failure_criteria: "Passwords are stored in plaintext or with weak hashing. Session tokens are not invalidated or are predictable. Lack of protection against brute-force attacks."

  - title: "OWASP — Sensitive Data Exposure"
    compliance_label: true
    objective: "To protect sensitive data (PII, credentials, financial info) from being exposed, both in transit and at rest."
    success_criteria: "All data transmission uses TLS (HTTPS). Sensitive data is encrypted at rest. Sensitive information is never logged. Secure headers (e.g., HSTS) are implemented."
    failure_criteria: "Data is transmitted over unencrypted channels (HTTP). Sensitive data is stored in plaintext. Secrets or PII are present in logs."

  - title: "OWASP — XML External Entities (XXE)"
    compliance_label: true
    objective: "To prevent attacks related to the processing of XML data from untrusted sources."
    success_criteria: "XML external entity processing is disabled in all XML parsers. The application prefers safer data formats like JSON where possible. All XML input is validated against a schema."
    failure_criteria: "The XML parser is configured to process external entities from untrusted sources, creating a vulnerability to information disclosure or SSRF."

  - title: "OWASP — Broken Access Control"
    compliance_label: true
    objective: "To ensure that users can only act within their intended permissions."
    success_criteria: "Access control is enforced on the server-side for every request. The principle of 'deny by default' is applied. Authorization checks are performed based on the user's session and role, not on parameters controlled by the user."
    failure_criteria: "Access control decisions are made on the client-side. Users can access unauthorized functionality by manipulating URLs or parameters (Insecure Direct Object References). Default access is permissive."

  - title: "OWASP — Security Misconfiguration"
    compliance_label: true
    objective: "To harden the application and its underlying components against attacks."
    success_criteria: "Default accounts and credentials have been removed or changed. Unnecessary features, ports, and services are disabled. Security headers (e.g., CSP, X-Frame-Options) are configured correctly. Error messages are generic and do not leak system information."
    failure_criteria: "The application runs with debug features enabled in production. Directory listing is enabled. Default credentials are in use. Verbose error messages reveal sensitive information."

  - title: "OWASP — Cross-Site Scripting (XSS)"
    compliance_label: true
    objective: "To prevent malicious scripts from being injected into and executed in the user's browser."
    success_criteria: "All untrusted data is properly escaped or encoded before being rendered in the UI. A Content Security Policy (CSP) is implemented to restrict the sources of executable scripts."
    failure_criteria: "User-supplied data is rendered directly in the browser without output encoding, allowing for script injection. The application lacks a restrictive CSP."

  - title: "OWASP — Insecure Deserialization"
    compliance_label: true
    objective: "To prevent remote code execution or other attacks resulting from deserializing untrusted data."
    success_criteria: "The application avoids deserializing objects from untrusted sources. If deserialization is necessary, it uses safe data formats and performs integrity checks (e.g., digital signatures) on the serialized data."
    failure_criteria: "The application deserializes data from untrusted clients without sufficient validation, potentially allowing object injection and remote code execution."

  - title: "OWASP — Using Components with Known Vulnerabilities"
    compliance_label: true
    objective: "To ensure that all third-party libraries, frameworks, and components are secure and up-to-date."
    success_criteria: "A process is in place to regularly scan for and identify vulnerable dependencies (e.g., using Dependabot, Snyk). Patches for known vulnerabilities are applied in a timely manner. Unused dependencies are removed."
    failure_criteria: "The application uses libraries or components with known, unpatched security vulnerabilities. There is no inventory or scanning process for dependencies."

  - title: "OWASP — Insufficient Logging & Monitoring"
    compliance_label: true
    objective: "To ensure that security events are logged and monitored to enable timely detection and response to attacks."
    success_criteria: "All authentication events, access control failures, and server-side input validation errors are logged with sufficient user context. Logs are stored securely and are monitored for suspicious activity."
    failure_criteria: "Security events are not logged, or logs lack the necessary detail to identify the attacker. There is no monitoring or alerting for suspicious log entries."

  - title: "HIPAA — PHI Handling and Audit Logging"
    compliance_label: true
    objective: "To prevent exposure of Protected Health Information (PHI) in logs and ensure all access to PHI is traceable."
    success_criteria: "The code does not log any data that could be considered PHI. All access to PHI (read, create, update, delete) is recorded in a secure, immutable audit log, including user ID, timestamp, and the nature of the access."
    failure_criteria: "PHI is written to application logs, even at debug levels. Access to PHI is not logged, or the audit logs are incomplete, making it impossible to trace who accessed what and when."

  - title: "HIPAA — PHI Encryption (In-Transit & At-Rest)"
    compliance_label: true
    objective: "To protect the confidentiality and integrity of PHI by using strong, industry-standard encryption for all data, both while it is being transmitted and while it is stored."
    success_criteria: "All network communication transmitting PHI uses strong, modern TLS (1.2 or higher). PHI stored in databases, file systems, or other persistent storage is encrypted at rest using a strong algorithm (e.g., AES-256)."
    failure_criteria: "PHI is transmitted over unencrypted channels (e.g., HTTP). PHI is stored in plaintext in the database or on disk. Weak or outdated encryption protocols/ciphers are used."

  - title: "PCIDSS — Cardholder Data Protection"
    compliance_label: true
    objective: "To protect cardholder data by avoiding storage where possible, encrypting it when stored, and masking it when displayed."
    success_criteria: "The code does not store full PANs (Primary Account Numbers). If storage is unavoidable, the data is encrypted using strong cryptography (e.g., AES-256). PANs are masked (e.g., showing only the last four digits) in logs and user interfaces."
    failure_criteria: "Full credit card numbers are stored in plaintext. PANs are exposed in application logs or displayed in full on the UI, creating a high risk of data compromise."

  - title: "PCIDSS — Secure Authentication"
    compliance_label: true
    objective: "To enforce strong authentication for access to cardholder data environments."
    success_criteria: "The code enforces strong password policies (e.g., complexity, history, rotation). Session management is secure, with timeouts and proper invalidation. Two-factor authentication is implemented for accessing sensitive components."
    failure_criteria: "Weak password policies are in place. Sessions do not time out or are vulnerable to hijacking. Single-factor authentication is used for critical systems, failing to protect against credential theft."

  - title: "Generic — Secure Logging Practices"
    compliance_label: true
    objective: "To ensure logs are useful for debugging and auditing without exposing sensitive information like PII, PHI, or cardholder data."
    success_criteria: "Logs are structured (e.g., JSON) for easy auditing. No sensitive data (PII, PHI, secrets, etc.) is present in any log output, at any log level."
    failure_criteria: "Sensitive data such as passwords, API keys, or personal user information is found in application logs. Logs are unstructured, making them difficult to parse and monitor effectively."

  - title: "Generic — Comprehensive Audit Trails"
    compliance_label: true
    objective: "To create a detailed and reliable record of critical system actions for security analysis and compliance."
    success_criteria: "All critical actions (e.g., read/write/delete of sensitive data, permission changes, user login events) are logged. Each log entry includes a user ID, timestamp, a clear description of the action, and the outcome."
    failure_criteria: "Critical actions are not logged, or the audit logs lack essential context, such as which user performed the action or what the action entailed, making it impossible to reconstruct events."

  - title: "Generic — Secure Error Handling"
    compliance_label: true
    objective: "To prevent the leakage of sensitive system information through error messages while providing sufficient detail for internal debugging."
    success_criteria: "User-facing errors are generic and do not expose internal implementation details (e.g., 'An internal error occurred'). Detailed error information, including stack traces, is only written to secure, internal logs."
    failure_criteria: "Stack traces, database error messages, or other internal system details are exposed to the end-user. Error messages inadvertently reveal sensitive information, such as the existence of a user account."
